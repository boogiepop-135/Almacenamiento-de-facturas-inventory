[providers]
node = "18"

[phases.setup]
nixPkgs = { nodejs = "18" }

[phases.install]
cmds = [
  "cd /app && cd frontend && npm ci || echo 'Frontend install failed'",
  "cd /app && cd backend && npm ci || echo 'Backend install failed'"
]

[phases.build]
cmds = [
  "echo '=== Building Frontend ==='",
  "cd /app/frontend && npm run build",
  "echo '=== Verificando build ==='",
  "ls -la /app/frontend/dist || (echo 'ERROR: Frontend dist no encontrado' && exit 1)",
  "echo '=== Frontend build exitoso ==='",
  "echo 'Backend build complete'"
]

[start]
cmd = "cd /app/backend && npm start"

